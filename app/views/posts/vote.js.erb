<% if @vote.new_record? %>
  <% @vote.vote = @submitted_vote %>
  <% @vote.save %>
<% elsif @vote.persisted? && @vote.vote == !@submitted_vote %>
  <% @vote.update(vote: @submitted_vote) %>
<% elsif @vote.persisted? && @vote.vote == @submitted_vote %>
  bootbox.alert("You have already voted on this post.");
<% else %>
  bootbox.alert("Sorry, your vote couldn't be counted.");
<% end %>

// Reload the vote partials
$("#<%= dom_id(@post) %>_voting_box").html("<%= j render 'voting_box', obj: @post %>");
$("#<%= dom_id(@post) %>_voting_box_mobile").html("<%= j render 'voting_box_mobile', obj: @post %>");
